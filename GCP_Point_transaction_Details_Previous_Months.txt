SELECT 
      EXTRACT(YEAR FROM Transaction_date) AS PT_YEAR,
      EXTRACT(MONTH FROM Transaction_date) AS PT_Month,
      COUNT(business_partner_id) AS Rec_Count
FROM (
      SELECT DATE(transaction_timestamp) as Transaction_date, business_partner_id
      FROM `loyalty-p-3bc1.loyalty_srv.point_transaction_detail`  
      WHERE DATE(transaction_timestamp) > '2023-06-30'
      AND DATE(transaction_timestamp) <= DATE_SUB(CURRENT_DATE(), INTERVAL 1 MONTH)
) AS PT
GROUP BY PT_YEAR, PT_Month