SELECT 
      EXTRACT(YEAR FROM Transaction_date) AS PT_YEAR,
      EXTRACT(MONTH FROM Transaction_date) AS PT_Month,
      COUNT(*) AS Rec_Count
   FROM (   
select date(TRANSACTION_TIMESTAMP) as Transaction_date
from P1_CDW_DMBASE..FT_ONL_CLUB_MEM_PNTS_TRANS_DTL
WHERE EXTRACT(YEAR FROM TRANSACTION_TIMESTAMP) = EXTRACT(YEAR FROM CURRENT_DATE)
AND EXTRACT(MONTH FROM TRANSACTION_TIMESTAMP) = EXTRACT(MONTH FROM CURRENT_DATE)
) AS PTD
GROUP BY PT_YEAR, PT_Month