SELECT 
      EXTRACT(YEAR FROM Transaction_date) AS PT_YEAR,
      EXTRACT(MONTH FROM Transaction_date) AS PT_Month,
      COUNT(*) AS Rec_Count
   FROM (   
select date(TRANSACTION_TIMESTAMP) as Transaction_date
from P1_CDW_DMBASE..FT_ONL_CLUB_MEM_PNTS_TRANS_DTL
where date(TRANSACTION_TIMESTAMP) >'2023-06-30'
AND DATE(TRANSACTION_TIMESTAMP) <= CURRENT_DATE - INTERVAL '1 MONTH'
) AS PTD
GROUP BY PT_YEAR, PT_Month