select count(distinct bpa.business_partner_no) AS No_Of_BP_IDs, date(ocmpb.last_transaction_timestamp) AS Last_Transaction_Timestamp, 
ch.country_code AS Dim_country_rk
from P1_CDW_DMBASE..ft_onl_club_member_point_bal  ocmpb
LEFT JOIN
  P1_CDW_DMBASE..dim_business_partner AS bpa
ON
  ocmpb.business_partner_id=bpa.business_partner_id
LEFT JOIN
  P1_CDW_DMBASE..dim_country AS ch
ON
  ocmpb.country_id=ch.country_id
where date(ocmpb.last_transaction_timestamp) in (CURRENT_TIMESTAMP-1)
group by ch.country_code, date(ocmpb.last_transaction_timestamp)
order by ch.country_code
